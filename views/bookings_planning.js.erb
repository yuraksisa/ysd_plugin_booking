require(['YSDSpreadSheet', 'jquery'], function(Spreadsheet, $) {

  planningModel = {

     bookingItems: [],
     month:6,
     year:2014,

     getBookingItems: function() {

       $.ajax({
               type: 'GET',
               url : '/api/booking-items',
               contentType: 'application/json; charset=utf-8',
               dataType : 'json',
               success: function(data, textStatus, jqXHR) {
                  planningModel.bookingItems = data.map(function(value, index, array) {
                    return value.reference;
                  });
                  planningView.update('items_available');
              }
          });

     }

  };

  planningController = {

  };

  planningView = {

    spreadsheet : null,

    init : function() {
      planningModel.getBookingItems();
    },

    update: function(event) {

      switch (event) {
         case 'items_available':
           this.buildSpreadsheet();
           break;
      }

    },

    buildSpreadsheet: function() {

      spreadsheet = new Spreadsheet("planning_table",  
          planningModel.bookingItems,            // items
          [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31], // days of month          
          planningModel.bookingItems.length,     // number of rows (items.count)
          "Planning",                            // 0-0 title
          "planning",                            // input prefix
          1,                                    // input size
          "",                                    // class
          true);                                 // readonly

    }


  };

  planningView.init();
});