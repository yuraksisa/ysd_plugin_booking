require(['jquery', 'YSDForms', 'jquery.ui', 'jquery.ui.touch-punch', 'ysdhtmleditor',], function($, YSDForms) {


  model = {

  };

  controller = {

      newPageButtonClick: function() {
          $('#modal_container .modal-body').load('/admin/cms/page-content/new #container',
              function(responseText, textStatus, jqXHR){
                  var dom = $('<html />').prop('innerHTML', html);
                  $('.modal-title').html('Nueva página');
                  htmlEditor('.texteditor');
                  $('[data-toggle="tabs"] a, .js-tabs a').click(function(e){
                      e.preventDefault();
                      $(this).tab('show');
                  });
                  $('#modal_container').modal('show');
              }
          );
      },

      editPageButtonClick: function(id) {
          $('#modal_container .modal-body').load('/admin/cms/page-content/'+id+'/edit #container',
              function(responseText, textStatus, jqXHR){
                  var dom = $('<html />').prop('innerHTML', html);
                  $('.modal-title').html('Editar página');
                  htmlEditor('.texteditor');
                  $('[data-toggle="tabs"] a, .js-tabs a').click(function(e){
                      e.preventDefault();
                      $(this).tab('show');
                  });
                  $('#modal_container').modal('show');
              }
          );
      },

      deletePageButtonClick: function() {

      },

      openInBrowser: function(url) {
          window.open(url,'_blank');
      }

  };

  view = {

      init: function() {
          YSDForms.improve();
          $('.sortable').sortable();
          $('.sortable').disableSelection();
          $('.open_in_browser_button').bind('click', function() {
              controller.openInBrowser($(this).attr('rel'));
          });
          $('#new_page_button').bind('click', function() {
              controller.newPageButtonClick();
          });
          $('.edit_page_button').bind('click', function() {
              controller.editPageButtonClick($(this).attr('rel'));
          });
      }

  };

  $(document).ready(function() {
      view.init();
  });

});