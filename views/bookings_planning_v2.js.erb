<%= partial 'booking_planning.js'.to_sym %>

require(['jquery', 'jquery.ui', 'jquery.ui.datepicker-es', 
         'jquery.ui.datepicker.validation','jquery.formparams', 'datejs'], 
        function($) {

  planningModel = {

    month: new Date().getMonth()+1,
    year: new Date().getFullYear(),
    reference: null,
    product: null,

    init: function() {
      <% if @date_from %>
      this.dateFrom = new Date('<%=@date_from.strftime("%Y-%m-%d")%>');
      <% else %>
      this.dateFrom = new Date(this.year, this.month-1, 1);
      <% end %>
      <% if @mode == :stock and @reference %>
      this.reference = <%=@reference%>;
      <% elsif @mode == :product and @product %>
      this.product = '<%=@product%>';
      <% end %>
    } 
  }

  planningController = {

  } 

  planningView = {
 
    init: function() {
      bookingPlanningModel.dateFrom = planningModel.dateFrom;
      bookingPlanningModel.reference = planningModel.reference;
      bookingPlanningModel.product = planningModel.product;
  	  bookingPlanningView.init();
    }

  }

  planningModel.init();
  planningView.init();
});